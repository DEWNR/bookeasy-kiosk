<!DOCTYPE html>
<html>
    <head>
        <base target="_parent" />

        <title>iFrame height test</title>

        <style type="text/css">

            html, body {
                background-color:   transparent;
                overflow:           hidden;
            }

            body {
                box-sizing: content-box;
                margin:     0;
                min-height: 480px;
                padding:    0;
            }

        </style>

        <link href="css/bookeasy-kiosk.css?v=1" rel="stylesheet">

    </head>

    <body>

        <div class="js-region-gadget" id="content"></div>

        <script type="text/javascript" src="//gadgets.impartmedia.com/gadgets.jsz?key=7e5893292834eb2b34cd1d9b11437df9"></script>

        <script>

            // Intialise operator URLs; must be assigned to a global variable with the name BE_gadgetURLOverrides.
            // (This list is not yet complete.)
            var BE_gadgetURLOverrides = { // Camping URLs. (Note that this list is currently incomplete.)
                69781: parent.location.pathname,
                69783: parent.location.pathname,
                69839: parent.location.pathname,
                67592: parent.location.pathname,
                67453: parent.location.pathname,
                69782: parent.location.pathname,
                69784: parent.location.pathname,
                67985: parent.location.pathname,
                67434: parent.location.pathname,
                67590: parent.location.pathname
            };

            console.log(parent.location.pathname);

            (function () {
                var bookingDate = new Date(),
                    gadgetOptions = {
                        vcID:188,
                        accomOnlyMode:true,
                        collapseRefineTools:true,
                        customMapIcons: {
                            'accom':{
                                icon:'//www.environment.sa.gov.au/files/templates/00000000-0000-0000-0000-000000000000/c16a6c2a-2cdc-4f08-96b9-f1c11eb6f349/npsa-marker-general.png',
                                pinpoint: [13,45],
                                size: [26,45]
                            }
                        },
                        //defaultDate: bookingDate,
                        defaultSort:'name',
                        disabledTypes:["tours","events","carhire","packages"],
                        enableRegionSearch:false,
                        ignoreSearchCookie:true,
                        limitLocations: ['Innes National Park'],
                        period:1,
                        showAllAccom:true,
                        showList:false,
                        showLocationFilter:false
                    },
                    gadgetSelector = '.js-region-gadget',
                    locationFilter = ['Innes National Park'];

                BE.gadget.region(gadgetSelector, gadgetOptions);
                console.log(BE_gadgetURLOverrides);
            }());

            // Add a resize listener to continuously update the frame height
            // (Use a separate function so it's not affected by errors thrown
            // by the gadget.)
            (function () {
                var frame = {},
                    targetSelector = '.js-region-gadget';

                setInterval(function () {
                    var target = document.querySelector(targetSelector);

                    if (typeof target.scrollHeight == 'number' && target.scrollHeight != frame.height) {
                        frame.height = target.scrollHeight;
                        parent.postMessage(frame, 'http://www.environment.sa.gov.au');
                    }
                }, 300);
            }());

        </script>

    </body>

</html>
